# Roo Code Prompt Optimizer

## 描述
专门用于优化 Roo Code Architect 模式下的 prompt，充分利用 GPT-5.2 和 high reasoning 设置的能力。

## 使用场景
- 使用 Roo Code Architect 模式进行系统设计
- 模型配置为 GPT-5.2
- Reasoning 级别设置为 High

## Prompt 优化原则

### 1. 结构化思维引导
由于 reasoning 设置为 high，prompt 应当：
- 明确要求分步骤推理
- 提供清晰的问题分解框架
- 鼓励深度思考和多角度分析

### 2. Architect 模式优化
针对架构设计场景，prompt 应包含：
- 系统目标和约束条件
- 技术栈偏好和限制
- 可扩展性和可维护性要求
- 性能和安全考虑

### 3. GPT-5.2 特性利用
充分利用 GPT-5.2 的高级能力：
- 要求生成完整的架构决策文档
- 期待多种方案对比和权衡分析
- 利用其强大的代码理解和生成能力

## Prompt 模板

### 架构设计模板
```
# 项目背景
[简要描述项目目标和业务需求]

# 技术要求
- 技术栈：[列出偏好的技术栈]
- 规模：[用户量/数据量/并发量等]
- 关键约束：[性能/成本/时间等]

# 架构设计任务
请进行深度推理和分析，提供：

1. **问题分析**
   - 核心挑战识别
   - 技术难点预判
   - 风险评估

2. **架构方案**
   - 提供 2-3 种可行方案
   - 每种方案的优劣对比
   - 推荐方案及理由

3. **详细设计**
   - 系统模块划分
   - 数据流设计
   - 接口定义
   - 技术选型理由

4. **实施路径**
   - 分阶段实施计划
   - 关键里程碑
   - 技术风险应对

请充分运用你的推理能力，进行全面深入的分析。
```

### 代码重构模板
```
# 现有代码分析
[提供需要重构的代码上下文]

# 重构目标
- 改进点：[性能/可读性/可维护性等]
- 保持：[哪些功能或接口必须保持不变]
- 约束：[技术栈限制/向后兼容性等]

# 重构任务
请深度分析并提供：

1. **代码问题诊断**
   - 当前架构的主要问题
   - 代码异味识别
   - 潜在风险点

2. **重构策略**
   - 推荐的重构模式
   - 分步重构计划
   - 每步的风险评估

3. **重构实现**
   - 详细的代码改进方案
   - 关键代码示例
   - 测试策略

4. **质量保证**
   - 如何验证重构效果
   - 性能对比预期
   - 回滚策略

请进行全面的推理分析，确保方案的可行性和完整性。
```

### 技术选型模板
```
# 选型背景
- 项目类型：[Web应用/移动应用/后端服务等]
- 团队情况：[技术栈熟悉度/团队规模]
- 项目阶段：[初创/成长/成熟]

# 待选技术方向
[列出需要选型的技术领域，如：前端框架/数据库/部署方案等]

# 选型要求
请进行深度分析：

1. **技术调研**
   - 每个候选技术的核心特点
   - 适用场景和限制
   - 社区生态和成熟度

2. **对比分析**
   - 多维度对比表格
   - 学习曲线评估
   - 长期维护成本

3. **推荐方案**
   - 综合推荐结果
   - 决策依据详解
   - 潜在风险预警

4. **迁移路径**（如适用）
   - 从现有技术迁移的策略
   - 迁移成本和周期
   - 平滑过渡方案

请充分发挥推理能力，提供经过深思熟虑的建议。
```

## 优化技巧

### 1. 明确上下文
```
# 好的示例 ✓
我正在设计一个日活 100 万的社交应用后端，需要支持实时消息、动态流和关系图谱。
团队熟悉 Node.js 和 Python，云平台使用 AWS。

# 避免的示例 ✗
帮我设计一个后端系统。
```

### 2. 分层次提问
```
# 好的示例 ✓
首先，请分析这个需求的核心挑战。
然后，提供 2-3 种架构方案并对比。
最后，针对推荐方案给出详细设计。

# 避免的示例 ✗
给我一个完整的架构设计。
```

### 3. 利用推理能力
```
# 好的示例 ✓
请深度分析以下架构决策：
1. 为什么选择微服务而非单体？
2. 如何权衡一致性和可用性？
3. 各种缓存策略的适用场景是什么？

# 避免的示例 ✗
告诉我应该用什么架构。
```

### 4. 要求权衡分析
```
# 好的示例 ✓
请对比 PostgreSQL 和 MongoDB 在我的场景下的优劣：
- 数据模型灵活性
- 查询性能
- 事务支持
- 运维复杂度
- 团队学习成本

# 避免的示例 ✗
我应该用哪个数据库？
```

## 最佳实践

### DO（推荐做法）
- ✓ 提供充足的业务背景和技术上下文
- ✓ 明确约束条件和非功能性需求
- ✓ 要求分步骤推理和多方案对比
- ✓ 询问决策依据和权衡分析
- ✓ 要求提供实施路径和风险评估
- ✓ 鼓励深度分析和创新思考

### DON'T（避免做法）
- ✗ 问题过于宽泛没有具体上下文
- ✗ 只要求单一答案不要求推理过程
- ✗ 忽略团队能力和现有技术栈
- ✗ 不说明项目规模和性能要求
- ✗ 期待一步到位的完美方案
- ✗ 不考虑实施可行性和成本

## 示例对话

### 示例 1：微服务架构设计

**优化后的 Prompt：**
```
我需要为一个电商平台设计微服务架构，请进行深度分析：

# 项目背景
- 当前：单体应用，日活 10 万
- 目标：支持 100 万日活，国际化扩展
- 痛点：部署慢、局部故障影响全局、技术栈锁定

# 技术栈
- 后端：Java/Spring Boot（主要）、Node.js（可选）
- 数据库：MySQL（现有）
- 中间件：Redis、RabbitMQ（现有）
- 云平台：阿里云

# 分析要求
1. 如何拆分服务？请给出拆分原则和具体的服务边界建议
2. 如何处理分布式事务？对比 Saga、TCC 等方案
3. 如何设计服务间通信？同步 vs 异步的取舍
4. 如何保证系统可观测性？监控、日志、追踪方案
5. 分阶段迁移策略：如何从单体平滑过渡？

请充分运用推理能力，分析每个决策点的权衡。
```

### 示例 2：性能优化

**优化后的 Prompt：**
```
我的 API 响应时间从 100ms 增长到 2s，需要系统性的性能优化方案。

# 系统概况
- 技术栈：Express.js + MongoDB + Redis
- 规模：10 万日活，峰值 1000 QPS
- 症状：数据库查询慢、内存使用高、偶尔超时

# 现有监控数据
- 80% 请求耗时在数据库查询
- MongoDB 慢查询日志显示多个全表扫描
- Redis 命中率 60%（期望 90%+）
- Node.js 内存持续增长

# 分析任务
请深度分析并提供：

1. **问题诊断**
   - 根据症状推断根因（DB 索引？查询优化？N+1？内存泄漏？）
   - 优先级排序：哪些问题最紧急？

2. **优化方案**
   - 数据库层面：索引策略、查询优化、分库分表评估
   - 缓存层面：缓存策略优化、预热机制
   - 应用层面：代码优化点、异步处理
   - 架构层面：是否需要读写分离、CDN 等

3. **实施计划**
   - 快速见效的 Quick Win（1 周内）
   - 中期优化（1 个月）
   - 长期架构升级（3 个月）

4. **效果评估**
   - 每项优化的预期收益
   - 如何验证效果
   - A/B 测试策略

请进行系统性的推理分析，不要遗漏关键环节。
```

## 总结

使用此 skill 时，记住：
- **GPT-5.2** 有强大的推理和代码理解能力，要充分利用
- **High Reasoning** 模式适合复杂的架构决策和深度分析
- **Architect** 角色需要全局视角和长远思考
- 提供的上下文越详细，得到的方案越精准
- 鼓励模型展示推理过程，而不只是给出结论

通过结构化、分层次、多维度的 prompt 设计，可以最大化发挥 Roo Code 在架构设计中的价值。
